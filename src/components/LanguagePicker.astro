---
import { Globe } from 'lucide-react';
import { getLangFromUrl } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);

// Determine the opposite language URL
const currentPath = Astro.url.pathname;
const segments = currentPath.split('/').filter(Boolean);
let newLang = lang === 'es' ? 'en' : 'es';

// Replace or prepend language code
if (segments[0] === 'es' || segments[0] === 'en') {
    segments[0] = newLang;
} else {
    segments.unshift(newLang);
}
const togglePath = `/${segments.join('/')}`;
---

<div class="fixed top-6 right-6 z-50 flex items-center gap-2">
    <a href={togglePath} class="flex items-center gap-2 bg-black/80 border border-white/10 px-3 py-1 rounded text-xs font-mono text-muted hover:text-white hover:border-white/30 transition-all group">
       <Globe size={14} className="group-hover:rotate-180 transition-transform duration-500" />
       <span>{lang.toUpperCase()} <span class="text-[10px] opacity-50 mx-1">/</span> <span class="text-primary">{newLang.toUpperCase()}</span></span>
    </a>
</div>
