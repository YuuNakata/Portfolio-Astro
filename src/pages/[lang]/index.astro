---
import { Image } from 'astro:assets';
import avatarImage from '../../assets/avatar.jpg';
import Layout from '../../layouts/Layout.astro';
import CyberNav from '../../components/CyberNav.astro';
import LanguagePicker from '../../components/LanguagePicker.astro';
import { getLangFromUrl, useTranslations } from '../../i18n/utils';

export function getStaticPaths() {
  return [
    {params: {lang: 'es'}},
    {params: {lang: 'en'}},
  ];
}

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<Layout title="Raydel Reuco | Software Engineer">
    <!-- Language Picker -->
    <LanguagePicker />

    <div class="flex flex-col items-center justify-center h-full relative z-10 px-4 md:px-0">
        
        <!-- Elementos decorativos de fondo -->
        <div class="absolute top-10 left-10 font-mono text-xs text-muted opacity-50 hidden md:block text-left">
            {t('hero.location')}: ::1 <br/>
            {t('hero.status')}: ONLINE <br/>
            {t('hero.uptime')}: 99.9%
        </div>

        <!-- Mobile: Stacked layout / Desktop: Side by side -->
        <div class="flex flex-col md:flex-row items-center md:items-start gap-6 md:gap-10 max-w-4xl">
            
            <!-- Avatar Section -->
            <div class="flex flex-col items-center md:items-center shrink-0">
                <!-- Avatar Glitch -->
                <div class="relative group mb-4">
                    <div class="absolute -inset-1 bg-linear-to-r from-primary to-secondary rounded-lg blur opacity-20 group-hover:opacity-75 transition duration-1000 group-hover:duration-200"></div>
                    <div class="relative w-24 h-24 md:w-36 md:h-36 bg-black border border-white/10 flex items-center justify-center overflow-hidden rounded-lg">
                        <Image 
                            src={avatarImage} 
                            alt="Raydel Reuco - Software Engineer" 
                            width={144} 
                            height={144}
                            format="webp"
                            quality={80}
                            class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500" 
                        />
                    </div>
                    <!-- Decoración esquina -->
                    <div class="absolute -bottom-2 -right-2 w-3 h-3 border-b-2 border-r-2 border-primary"></div>
                    <div class="absolute -top-2 -left-2 w-3 h-3 border-t-2 border-l-2 border-primary"></div>
                </div>

                <!-- Name with Typing Effect - NAKATA BRANDING -->
                <h1 class="font-pixel-serif text-2xl md:text-4xl tracking-tight flex items-center justify-center">
                    <span id="typing-text">NAKATA</span> 
                    <span class="animate-pulse text-primary ml-1">_</span>
                </h1>
            </div>

            <!-- Content Section -->
            <div class="flex flex-col text-center md:text-left">
                <div class="font-mono text-xs md:text-sm text-muted space-y-3 md:space-y-4 border-l-2 border-primary/20 pl-4 py-2 bg-white/5">
                    <p>> <span class="text-primary">{t('hero.degree')}</span> @ Universidad de las Ciencias Informáticas (UCI)</p>
                    <p>> {t('hero.focus')} <span class="text-secondary">Full Stack Development</span> & <span class="text-secondary">Software Engineering</span>.</p>
                    <p class="opacity-80 leading-relaxed text-[10px] md:text-xs">
                       {t('hero.bio')}
                    </p>
                    <div class="flex gap-2 text-[10px] pt-2 justify-center md:justify-start">
                         <span class="bg-primary/10 text-primary px-2 py-1">PYTHON</span>
                         <span class="bg-secondary/10 text-secondary px-2 py-1">C#</span>
                         <span class="bg-white/10 text-white px-2 py-1">TYPESCRIPT</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Select Module Text - Positioned below everything -->
        <div class="mt-10 md:mt-14">
            <p class="text-[10px] text-muted font-pixel animate-bounce">{t('hero.select_module')}</p>
        </div>
    </div>

    <CyberNav slot="nav" />
</Layout>

<script>
    const textToType = "NAKATA";
    const typingElement = document.getElementById('typing-text');
    let isTyping = false;

    function typeEffect() {
        if (!typingElement || isTyping) return;
        isTyping = true;
        
        // Clear fully first
        typingElement.textContent = "";
        
        let i = 0;
        const speed = 150; // ms per char

        function typeChar() {
            if (i < textToType.length) {
                typingElement!.textContent += textToType.charAt(i);
                i++;
                setTimeout(typeChar, speed);
            } else {
                isTyping = false;
            }
        }

        typeChar();
    }

    // Start immediately on load (or view transition)
    document.addEventListener('astro:page-load', () => {
        // Initial run
        typeEffect();

        // Loop every 5 seconds
        setInterval(typeEffect, 5000);
    });
</script>
